---
title: crontab in docker
abbrlink: ca10b1f5
date: 2020-04-15 11:30:40
categories: [Software, cron]
tags:
- docker
- cron
---
#### 手動執行cron task，並查看目前系統中執行的cron task
```bash
$ docker cp cron-task container:/etc/cron.d/
root@847d0eb77dfe:/# cd /etc/cron.d/
root@847d0eb77dfe:/etc/cron.d# crontab cron-task
root@847d0eb77dfe:/etc/cron.d# cd /var/spool/cron/crontabs/
root@847d0eb77dfe:/var/spool/cron/crontabs# cat root
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (parse-log-cron installed on Wed May  1 14:55:42 2019)
# (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)
00 * * * * run-one /usr/bin/python3.6 /app.py
```

#### 在Dockerfile中設定cron task
1. create cron-task
```bash
00 * * * * run-one /usr/bin/python3.6 /app.py
```

2. in Dockerfile
* apt-get install cron run-one
* add cron tasks script
```bash
RUN apt-get update && \
    apt-get install --no-install-recommends -y cron run-one && \
ADD cron_task /etc/cron.d/cron-task
RUN chmod 0644 /etc/cron.d/cron-task && \
    crontab /etc/cron.d/cron-task
```

3. in supervisord.conf
```bash
[program:cron]
command=/usr/sbin/cron -f

stdout_logfile_maxbytes = 0
stdout_logfile = /dev/stdout
stderr_logfile_maxbytes = 0
stderr_logfile = /dev/stderr
```